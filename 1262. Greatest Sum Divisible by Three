class Solution {
    public int maxSumDivThree(int[] nums) {
        int sum = 0;
        
        // Initialize variables to store the smallest and second smallest
        // numbers with remainder 1 and 2. 
        // 10001 is used as "infinity" since max element constraint is 10000.
        int r1_min1 = 10001, r1_min2 = 10001;
        int r2_min1 = 10001, r2_min2 = 10001;

        for (int num : nums) {
            sum += num;
            
            if (num % 3 == 1) {
                if (num < r1_min1) {
                    r1_min2 = r1_min1;
                    r1_min1 = num;
                } else if (num < r1_min2) {
                    r1_min2 = num;
                }
            } else if (num % 3 == 2) {
                if (num < r2_min1) {
                    r2_min2 = r2_min1;
                    r2_min1 = num;
                } else if (num < r2_min2) {
                    r2_min2 = num;
                }
            }
        }

        int remainder = sum % 3;
        
        if (remainder == 0) {
            return sum;
        } else if (remainder == 1) {
            // To fix remainder 1, remove one r1 OR two r2s
            int removeOne = r1_min1;
            int removeTwo = r2_min1 + r2_min2;
            return Math.max(sum - Math.min(removeOne, removeTwo), 0);
        } else {
            // To fix remainder 2, remove one r2 OR two r1s
            int removeOne = r2_min1;
            int removeTwo = r1_min1 + r1_min2;
            return Math.max(sum - Math.min(removeOne, removeTwo), 0);
        }
    }
}
